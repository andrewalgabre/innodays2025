<div class="camera-container">
  <!-- Header -->
  <header class="camera-header">
    <button class="btn-icon btn-secondary" (click)="goBack()">
      <lucide-icon name="arrow-left"></lucide-icon>
    </button>
    <h1 class="camera-title">Klauen-Scan</h1>
    <div class="spacer"></div>
  </header>

  <!-- Camera View -->
  <div class="camera-view">
    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-state">
      <lucide-icon name="loader-2" class="loading-icon animate-spin"></lucide-icon>
      <p>Kamera wird gestartet...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !isLoading" class="error-state">
      <lucide-icon name="alert-circle" class="error-icon"></lucide-icon>
      <h3>Kamera-Fehler</h3>
      <p>{{ error }}</p>
      <button class="btn btn-primary" (click)="startCamera()">
        <lucide-icon name="rotate-cw"></lucide-icon>
        Erneut versuchen
      </button>
    </div>

    <!-- Video Preview -->
    <video
      #videoElement
      *ngIf="isCameraActive && !isLoading"
      class="video-preview"
      autoplay
      playsinline
      muted
    ></video>

    <!-- Camera Guide Overlay -->
    <div *ngIf="isCameraActive && !isLoading" class="guide-overlay">
      <div class="guide-frame"></div>
      <div class="guide-text">
        <p>Positionieren Sie die Kuhklaue im Rahmen</p>
        <p class="text-muted">Sorgen Sie f√ºr gute Beleuchtung und klare Sicht</p>
      </div>
    </div>
  </div>

  <!-- Camera Controls -->
  <div class="camera-controls" *ngIf="isCameraActive && !isLoading">
    <!-- Top Controls -->
    <div class="controls-top">
      <button
        class="btn-icon btn-secondary control-btn"
        (click)="toggleFlash()"
        [class.active]="flashEnabled"
      >
        <lucide-icon name="rotate-cw"></lucide-icon>
      </button>

      <button
        class="btn-icon btn-secondary control-btn"
        (click)="switchCamera()"
      >
        <lucide-icon name="rotate-cw"></lucide-icon>
      </button>
    </div>

    <!-- Capture Button -->
    <div class="controls-center">
      <button class="gallery-button" (click)="selectImageFromGallery()">
        <lucide-icon name="image"></lucide-icon>
      </button>
      <button class="capture-button" (click)="capturePhoto()">
        <div class="capture-button-inner"></div>
      </button>
    </div>

    <!-- Bottom Info -->
    <div class="controls-bottom">
      <div class="info-card">
        <lucide-icon name="info"></lucide-icon>
        <span>Tippen Sie, um das Bild aufzunehmen</span>
      </div>
    </div>
  </div>
</div>
